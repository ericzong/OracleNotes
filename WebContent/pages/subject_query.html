<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="author" content="Eric Zong">
<title>查询</title>
<link type="text/css" rel="stylesheet" href="../css/common.css"  />
<link type="text/css" rel="stylesheet" href="../css/print.css" media="print" />
<link type="text/css" rel="stylesheet" href="../css/title.css"  />
<script type="text/javascript" src="../js/title.js"></script>
</head>
<body>
  <h1>多表查询</h1>
  <p>连接查询的理论基础是笛卡尔积。</p>
  <p>多表查询的连接条件：不能少于表的个数-1，如4张表的关联至少需要3个条件才能避免出现笛卡尔积。</p>
  
  <h1>多列子查询</h1>
  <p>多列子查询则是指返回多列数据的子查询语句。</p>
  <pre class="code">select * from emp where (deptno,job)=(select deptno,job from emp where ename = 'Smith');</pre>
  <h2>单行比较 vs. 多行比较</h2>
  <p>当多列子查询返回单行数据时，在where子句中可以使用单行比较符。（=，!=，...）</p>
  <p>而返回多行数据时，在where字句中必须使用多行比较符。（in，all，any）</p>
  <h2>成对比较 vs. 非成对比较</h2>
  <p>使用子查询比较多个列的数据时，既可以使用成对比较，也可以使用非成对比较。其中，成对比较要求多个列的数据必须同时匹配，而非成对比较则不要求多个列的数据必须同时匹配。</p>
  <pre class="code">
<span class="comment">--成对比较示例</span>
SELECT ename, sal, comm, deptno FROM emp
  WHERE (sal, nvl(comm, -1)) IN (SELECT sal, nvl(comm, -1) FROM emp WHERE deptno=30);
<span class="comment">--非成对比较示例</span>
SELECT ename, sal, comm, deptno FROM emp
  WHERE sal IN (SELECT sal FROM emp WHERE deptno=30) AND nvl(comm, -1) IN (SELECT nvl(comm, -1) FROM emp WHERE deptno=30);</pre>  
  
  <h1>排序</h1>
  <p>排序可以使用以下方式：</p>
  <ul>
    <li>列名</li>
    <li>表达式</li>
    <li>别名</li>
    <li>数字序号</li>
  </ul>
  
  <h2>表达式排序</h2>
  <p>除了直接指定列名排序外，还可依据表达式对数据排序。</p>
  <pre class="code">
select * from emp order by sal*12 desc;</pre>

  <h2>别名排序</h2>
  <p>排序操作可使用别名。若在 select 语句中定义了列的别名，那么该列名可以使用在 order by 子句中，对于包含了表达式的排序来说，
  使用别名排序可以增强查询结果的可读性。</p>
  
  <h2>数字序号排序</h2>
  <p>排序操作可使用数字序号代替列名称。数字序号代表列名称由 select 子句后面的列名顺序决定。</p>
  <pre class="code">
select ename, job, hiredate, sal from emp
  order by hiredate, sal desc;
等价于：
select ename, job, hiredate, sal from emp
  order by 3 sal desc;
  </pre>
  
  <h1>附录</h1>
  <h2>转义</h2>
  <p>escape 子句可把“_”和“%”从特殊标志返回到普通字符。escape 子句用来指定一个退出符号，该退出符号后面的字符被作为普通字符对待。</p>
  <pre class="code">
select ... from ...
  where ... like 'A<span class="notice">\</span>%' escape '<span class="notice">\</span>';</pre>
  
  <h2>其它</h2>
  <p>between...and... 包含边界值。</p>
</body>
</html>