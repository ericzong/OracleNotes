<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="author" content="Eric Zong">
<title>查询参考</title>
<link type="text/css" rel="stylesheet" href="../css/common.css"  />
<link type="text/css" rel="stylesheet" href="../css/print.css" media="print" />
<link type="text/css" rel="stylesheet" href="../css/title.css"  />

<script type="text/javascript" src="../js/title.js"></script>
<script type="text/javascript" src="../js/highlight.pack.js"></script>
<script type="text/javascript">hljs.initHighlightingOnLoad();</script>
</head>
<body>
  <h1>磁盘相关信息查询</h1>
  <pre class="code">
select a.tablespace_name 表空间,
       c.file_name 表空间数据文件,
       c.bytes / 1024 / 1024 || 'M' 该数据文件大小,
       a.total_bytes || 'M' 总计,
       a.total_bytes - nvl(b.free_bytes, 0) || 'M' 已使用,
       round((a.total_bytes - nvl(b.free_bytes, 0)) / a.total_bytes, 4) * 100 || '%' 表空间已使用百分比,
       nvl(b.free_bytes, 0) || 'M' 表空间剩余,
       round(nvl(b.free_bytes, 0) / a.total_bytes, 4) * 100 || '%' 表空间剩余百分比
  from (select df.tablespace_name, sum(df.bytes) / 1024 / 1024 Total_bytes
          from dba_data_files df
         group by df.tablespace_name) a,
       (select fs.tablespace_name, sum(fs.bytes) / 1024 / 1024 Free_bytes
          from dba_free_space fs
         group by fs.tablespace_name) b,
       dba_data_files c
 where a.tablespace_name = b.tablespace_name(+)
   and a.tablespace_name = c.tablespace_name
 order by a.total_bytes desc</pre>
</body>
</html>